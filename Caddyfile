:80 {
    # Serve frontend static assets
    root * /usr/share/caddy

    # Forward API requests to the Rust backend
    handle /api/* {
        reverse_proxy 127.0.0.1:8000
    }

    # Forward health check
    handle /health {
        reverse_proxy 127.0.0.1:8000
    }

    # Handle Next.js client-side routing
    handle {
        try_files {path} {path}.html /index.html
        file_server
    }

    # Compression for better performance
    encode gzip zstd

    # Logging
    log {
        output stdout
    }
}
